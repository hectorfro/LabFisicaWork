\chapter{Representación y análisis gráfico}

\section{Introducción}

En este capítulo, se aprenderá cómo representar datos experimentales de manera efectiva mediante gráficos. Se abordarán técnicas para la creación de gráficos claros y comprensibles, así como para el análisis de datos a través de regresión lineal y la interpretación de pendientes e intersecciones.

Para el científico, analista de datos o persona con la responsabilidad  de escribir documentos técnicos es importante que desarrolle competencias en las técnicas de visualización de datos. Las presentaciones con gráficos deben ser claras, atractivas y sobre todo convincentes, muchas veces deben lograr traducir cantidades numéricas a ideas que permitan hacer extrapolaciones y proyecciones a situaciones futuras. Las técnicas de visualización de datos termina siendo algo que se aprende con el oficio, con el día a día del trabajo de investigación y pocas veces se enseña en las universidades

El propósito de este capítulo es hacer una pequeña introducción sobre visualización de datos y como usarlos en el análisis de los datos experimentales. 

\section{Tabulación de datos y resultados}

La Física es una ciencia experimental y cuantitativa, depende del trabajo de laboratorio donde se tendrá la necesidad de medir magnitudes y procesar datos.

Es una norma básica que dichos datos deben ser presentados en forma clara y ordenada, y la mejor forma para lograr esto es ubicar los datos en tablas, donde se destinen diferentes columnas a cada conjunto de datos. Conocer en qué consiste la tabulación de los datos y cómo hacerlo correctamente puede resultar de gran ayuda a la hora de realizar las diferentes etapas de  procesamiento y visualización, facilita considerablemente la comprensión, el análisis y la interpretación de los datos para llevar a cabo comparaciones y obtener conclusiones válidas. 

Las ventajas de este proceso de tabulación son las siguientes:
\begin{enumerate}
\item Cumplir con condiciones de claridad y orden.
\item Facilitar la lectura y la comprensión de los datos.
\item Reducir las posibilidades de equivocación al tomar valores para calcular.
\end{enumerate}

Las Tablas deben ser lo más autocontenidas posibles, sus títulos y  leyendas deben ser suficiente para explicar su contenido. Las leyendas de tablas y figuras deben ser más que una simple descripción. Deben generar una reflexión una conclusión al presentar la tabla o figura. En textos científicos las tablas deben ser referidas desde el texto (ver Tabla \ref{ejetabla1}). Si no se hace referencia a una tabla en particular, ésta se considera inútil para el artículo y debe ser eliminada.

La confección de tablas de valores no se limita necesariamente a los datos que se recogen directamente en el trabajo experimental, sino que puede extenderse a los resultados de efectuar operaciones con dichos datos. Además en dichas tablas, deben disponerse columnas para colocar en ellas el error con el cual dichas magnitudes han sido medidas, siempre que este sea diferente en cada medición.

Las tablas en las que se recopilan y se organizan los datos deben contar con las siguientes partes:
\begin{itemize}
\item Título de la tabla: debe ser breve, conciso y claro.
\item Contenido de la tabla:  deben aparecer las magnitudes con sus respectivos nombres y unidades, preferiblemente  en el mismo sistema de unidades.
\item Número de la tabla.
\item Notas explicativas: hacer referencia a la fuente de los datos, explicación de las abreviaturas, consideraciones a tener en cuenta, etc. 
\end{itemize}

Como ejemplo de lo dicho anteriormente se presenta una tabla de valores obtenida en una experiencia de movimiento rectilíneo uniformemente acelerado, ver tabla \ref{ejetabla1}

\begin{table}[!h]
\centering
\caption{Velocidad de carrera sobre 200$ \mathrm{~m}$ y distancia de salto de longitud  de un grupo de personas seleccionadas al azar.}
\begin{tabular}{ccc}
\hline Participante & Velocidad $\left(\mathrm{ms}^{-1}\right)$ & Distancia $(\mathrm{m})$ \\ \hline \hline 
1 & 10.53 & 2.38 \\
2 & 11.16 & 1.83 \\
3 &  9.54  & 2.04 \\
4 & 15.77 & NA\footnote{El participante 4 no pudo realizar el salto de longitud  por razones médicas} \\
5 & 12.82 & 1.74 \\
& & \\
Total & 59.82 & 7.99 \\
Promedio & 11.964 & 1.997 \\
\hline
\end{tabular}
\label{ejetabla1}
\end{table}


\section{Representaciones  gráficas}

La representación de gráficas o la visualización de datos es una técnica artística que permite transmitir el conocimiento científico. Con la visualización de datos se debe transmitir de manera precisa la información científica relevante sin distorsionar su contenido. No debe contener información falsa ni errónea. Es necesario que la visualización sea agradable desde el punto de vista estético, si las figuras se muestran con colores poco armónicos, elementos visuales engorrosos traerá como consecuencia que el espectador no pueda interpretar la figura de manera correcta. 

En muchos casos, una acertada visualización de datos  permite determinar valores que no han sido obtenidos experimentalmente, como son:
\begin{enumerate}
\item Valores entre puntos experimentales (proceso de Interpolación).
\item Valores fuera del intervalo experimental (proceso de Extrapolación).
\item Valores de los parámetros constantes de la función matemática usada.
\end{enumerate}

En la figura \ref{estilosfig}\footnote{Tomada de: \url{https://clauswilke.com/dataviz/}.} podemos ver algunos ejemplos  de cómo hacer una buena visualización y otras como ejemplos de cómo no hacerla.  Una figura  que muestre problemas estéticos pero que cumple con su función de ser clara e informativa es una figura que podríamos llamar ``fea''. Una figura ``mala'' es aquella que es poco clara, confusa, complicada, engañosa, mientras que una figura ``incorrecta'' es aquella que presenta información errónea, presenta inconsistencias matemáticas que inevitablemente llevará a una interpretación equivocada de los datos.
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.5in,width=3.6in]{figuras/fig08}  
\caption{En (a) se muestra  un diagrama de barras para tres valores: A = 3, B = 5 y C = 4;  es una representación sencilla y entendible. (b) es una versión fea de la parte (a), aunque el gráfico es técnicamente correcto, es estéticamente desagradable, con colores innecesarios, una cuadrícula de fondo absurda y un texto con tipos de letra y tamaños diferentes. (c) es una mala versión de la parte (a), en el eje $y$ cada barra tiene  su propia escala y además están desalineadas, por lo tanto es una gráfica engañosa. (d) es una versión incorrecta de la parte (a), como el eje $y$ no pose escalas no es posible determinar sus valores numéricos.}
\label{estilosfig}
\end{center}
\end{figure}


Cuando se grafican valores experimentales o magnitudes calculadas se debe considerar:

\subsection{Ejes de coordenadas}

En muchas casos, cuando se quiere visualizar datos se necesita definir escalas que permitan posicionar los datos en un gráfico. En gráficos 2D se necesitan dos números para especificar un punto de manera unívoca, es decir, dos escalas de posición. Estas dos escalas suelen ser los ejes $x$ (eje horizontal o eje de las abscisas) y el eje $y$ (eje vertical o eje de las ordenadas), es lo generalmente  se denomina el sistema de coordenadas.

\begin{enumerate}
\item En los ejes deben aparecer claramente las magnitudes, símbolo o letra, que en ellos se representan y sus unidades de medida correspondientes

\item En los ejes sólo deben colocarse los valores más representativos de la escala escogida.

\item En general, es conveniente que el origen aparezca en el gráfico, pero no siempre es necesario que la intersección de los dos ejes corresponda al punto cero; en este caso las escalas pueden desplazarse cuando los datos experimentales están en un intervalo que así lo requiera.

\item La variable independiente, cuyo valor lo asigna a conveniencia el experimentador, se representa sobre el eje $x$ horizontal y la variable que depende de ese valor asignado se coloca sobre el eje $y$ vertical.
\end{enumerate}


\subsection{Selección de escalas}
La escogencia de las escalas a utilizar es un problema si no se tiene cuidado al considerar factores como: el tamaño del conjunto de datos, las divisiones sobre cada eje, la relación entre los errores experimentales y los valore mínimos elegidos en las escalas. 

Las escala no deben ser muy pequeña, ya que en este  caso se  pueden agrupar exageradamente los puntos en una región de la gráfica (ver figura \ref{escala1}). Tampoco deben elegirse escalas grandes que exageran la precisión.
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.5in,width=3.6in]{figuras/fig09}  
\caption{Muy mala selección de las escalas.}
\label{escala1}
\end{center}
\end{figure}

Una gráfica puede requerir  tener dos ejes que representan dos unidades diferentes, por ejemplo Temperatura en $^\circ$C vs Tiempo en s.  Estirar o comprimir los ejes obedecerá a las razones que necesitemos resaltar, una gráfica alta y estrecha enfatiza el cambio a lo largo del eje $y$ y una corta y ancha hace lo contrario. Lo ideal es elegir una relación de aspecto que garantice que las diferencias importantes de posición sean perceptibles.

Por otro lado, si los ejes $x$ y $y$ se miden en las mismas unidades, entonces las separaciones de la cuadrícula para los dos ejes deben ser iguales, de forma que la misma distancia a lo largo del eje $x$ o $y$ corresponda al mismo número de unidades de datos.

Los sistemas de coordenadas cartesianos son sistemas de coordenadas lineales y aunque 
suelen proporcionar una representación precisa de los datos, hay situaciones en las que se prefiere utilizar escalas no lineales. En una escala no lineal, a un espaciado uniforme en las unidades de datos le corresponde un espaciado desigual en la visualización o, contrariamente, a un espaciado uniforme en la visualización le corresponde un espaciado desigual en las unidades de datos.

La escala no lineal más utilizada es la escala logarítmica o escala logarítmica abreviada, estas escalas  son lineales en la multiplicación, de forma que un paso unitario en la escala corresponde a una multiplicación con un valor fijo. Para crear una escala logarítmica, debemos realizar una transformación logarítmica de los valores de los datos y exponenciar los números que se muestran a lo largo de las líneas de la cuadrícula del eje.


\subsection{Ubicación de los puntos}

Los valores experimentales no deben ser graficadas sólo como un solo punto, se debe representar además el error absoluto con el cual se obtuvo dicho valor. Para ello se usan: cuadrados, rectángulos, barras, cruces, etc. (ver figura \ref{barerror}). Si la escala escogida no permite representar el error absoluto, los valores experimentales se deben representar con una equis o una cruz. Las barras de error suelen representarse a lo largo de las direcciones $x$ y  $y$ en un gráfico de dispersión.

En las figuras 2D sencillas, las barras de error tienen una ventaja importante sobre las representaciones más complejas de la incertidumbre ya que se pueden combinar con muchos otros tipos de gráficos. Por lo tanto, las barras de error resultan ser la representaciones más sencillas para mostrar cantidades con incertidumbre sobre todo en las gráficas de barras. 

Cada conjunto debe ser representado por un símbolo diferente, por ejemplo: $\times, \Delta, \odot,+$ e identificar luego cada curva. La recta o curva que siguen los puntos se debe trazar de un modo que la función sea lo más representativa posible del comportamiento de las magnitudes que caracterizan el fenómeno  en estudio.
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.2in,width=4.6in]{figuras/fig11}  
\caption{Representación de puntos experimentales con barras de error.}
\label{barerror}
\end{center}
\end{figure}


\section{Trazado de una recta}

En algunos experimentos las magnitudes físicas pueden variar linealmente, como es el caso de la deformación y la fuerza en la ley de Hooke $(F = -kx)$. Al realizar el experimento y graficar resulta  un conjunto de puntos que corresponde a un comportamiento lineal. 

El experimentador tiene que buscar ahora la mejor estrategia  para trazar la mejor recta que pasa por entre los puntos experimentales.

Los métodos estadísticos demuestran que, siempre que la dispersión de los puntos experimentales  se deba a los errores casuales de medición, la mejor recta pasará por el centroide de los puntos experimentales, que es el punto con las coordenadas
$(\bar{x}, \bar{y})$, en donde $\bar{x}$ y $\bar{y}$  son los  valores medios de las coordenadas $x$ y $y$ respectivamente.
\begin{equation}
\begin{aligned}
\bar{x} & =\frac{1}{n}{\sum_{i=1}^n x_i} \\
\bar{y} & =\frac{1}{n}{\sum_{i=1}^n y_i}
\end{aligned}
\end{equation}


Para ajustar la recta al conjunto de puntos experimentales, se emplearán los siguientes métodos:

\subsection{Método gráfico}
Este método es un método artesanal, y consiste en buscar sobre la gráfica la mejor recta que pase  por el centroide y la mayoría de los puntos experimentales. Aquellos puntos que queden por fuera de esta recta deben estar distribuidos en lo posible con igual peso a ambos lados de la curva.

Como sabemos, la ecuación de una recta es:
$$
y=m x+b
$$
donde:
\begin{itemize}
\item $m$ es la pendiente de la recta, calculada a partir de las coordenadas de dos puntos sobre la recta, necesariamente no tienen que corresponder a valores experimentales.
$$
m=\frac{\left(y_2-y_1\right)}{\left(x_2-x_1\right)} \frac{\text { unidad de } y}{\text { unidad de } x}
$$
\item  $b$ es el corte de la recta con el eje de las ordenadas en $x=0$.
\end{itemize}

El error absoluto para $m$ y $b$ viene dado por la lectura de la posición de los puntos sobre el gráfico, es decir en función de la apreciación de la escala en el eje respectivo.


\subsection{Método de los mínimos cuadrados}

El método de los mínimos cuadrados es uno de los métodos estadísticos más usados para determinar la recta que mejor represente la tendencia de un conjunto de puntos experimentales.

Si la dispersión de los puntos experimentales es debida solo a los errores casuales en las mediciones, la mejor recta será aquella para la cual la suma de los cuadrados de las distancias $\left(y_i-y_0 \right)$ sea un mínimo, ver figura 4.4. Es por esto que, a este método se le llama método de los mínimos cuadrados.

Consideremos una relación lineal entre dos magnitudes físicas $y$ y $x$ de la forma:
$$
y=m x+b
$$

Donde $y$ es la variable dependiente y $x$ es la variable independiente, en nuestro caso la magnitud controlada por el experimentador. Como ya se ha dicho anteriormente, los valores de esas magnitudes tendrán sus correspondientes errores, determinados por los métodos ya señalados. 

La desviación de un valor cualquiera $y_i$ determinado experimentalmente con respecto a su valor $y_0$ en la recta, será:
\begin{equation}
\Delta y_i=y_i-y_0=y_i-\left(b+m x_i\right)
\label{deltay}
\end{equation}

Ahora se puede enunciar el principio básico de este método, el cual dice que:

La mejor recta que puede ser trazada entre esos puntos, es aquella para la cual la suma de los cuadrados de las desviaciones $\Delta y_i$ de los datos experimentales, con respecto a esa recta, es mínima.
$$
\sum_{i=1}^n\left(\Delta y_i\right)^2=\sum_{i=1}^n \left[y_i-b-m x_i \right]^2
$$
donde $n$ es el número de pares de valores de $y$ y $x$.

Ya que la condición exigida es la de minimizar la suma anterior, entonces los parámetros $m$ y $b$ deben ajustarse para cumplir con esta condición. Ello se logra calculando las derivadas parciales de la suma con respecto a $m$ y con respecto a $b$, e igualándolas a cero.
$$
\begin{aligned}
& \frac{\partial\left[\sum\left(\Delta y_i\right)^2\right]}{\partial b}=
\sum_{i=1}^n\frac{\partial\left(y_i-b-m x_i \right)^2}{\partial b} = 
\sum_{i=1}^n -2(y_i-b-m x_i)=0  \\
& \frac{\partial\left[\sum\left(\Delta y_i\right)^2\right]}{\partial m}=
\sum_{i=1}^n\frac{\partial\left(y_i-b-m x_i \right)^2}{\partial m} =
\sum_{i=1}^n -2x_i(y_i-b-m x_i)=0
&
\end{aligned}
$$

Por lo tanto, se debe resolver el sistema 
$$
\begin{aligned}
&  \sum_{i=1}^n y_i - \sum_{i=1}^nb - \sum_{i=1}^n m x_i = 0  &\,\, \Rightarrow \,\,&
 nb + m \sum_{i=1}^n  x_i = \sum_{i=1}^n y_i  \\
&  \sum_{i=1}^n y_ix_i - \sum_{i=1}^n bx_i -\sum_{i=1}^n  m x_i^2 =0 & \,\, \Rightarrow \,\,&
b \sum_{i=1}^n x_i  + m \sum_{i=1}^n   x_i^2 = \sum_{i=1}^n y_ix_i
\end{aligned}
$$
para $m$ y $b$. 

Utilizando la regla de Cramer
$$
\begin{aligned}
\Delta= 
{\left|\begin{array}{cc}
n & \sum x_i \\
\sum x_i & \sum x_i^2
\end{array}\right|} = n \sum x_i^2-\left(\sum x_i\right)^2 \,,
\end{aligned}
$$

$$
\begin{aligned}
& b=\frac{\left|\begin{array}{cc}
\sum y_i & \sum x_i \\
\sum x_i y_i & \sum x_i^2 
\end{array}\right|}{\Delta}=\frac{\sum x_i^2 \sum y_i-\sum x_i \sum x_i y_i}{n \sum x_i^2-\left(\sum x_i\right)^2} \\ \\
& m=\frac{\left|\begin{array}{cc}
n & \sum y_i \\
\sum x_i & \sum x_i y_i
\end{array}\right|}{\Delta}=\frac{n\sum x_i y_i-\sum x_i \sum y_i}{n \sum x_i^2-\left(\sum x_i\right)^2}
\end{aligned}
$$

Por lo tanto:
\begin{eqnarray}
b &=&\dfrac{\sum\limits_{i=1}^n x_i^2 \sum\limits_{i=1}^n y_i-\sum\limits_{i=1}^n x_i \sum\limits_{i=1}^n x_i y_i}{n\sum\limits_{i=1}^n x_i^2-\left(\sum\limits_{i=1}^n x_i\right)^2} 
\label{emeyb1}\\
m &=&\dfrac{ n\sum\limits_{i=1}^n x_i y_i-\sum\limits_{i=1}^n x_i \sum\limits_{i=1}^n y_i}{n \sum\limits_{i=1}^n x_i^2-\left(\sum\limits_{i=1}^n x_i\right)^2}
\label{emeyb2}
\end{eqnarray}

De esta manera obtenemos la recta $f(x)=mx+b$ que mejor de aproxima a los puntos. 

Nótese que los términos $\sum x_i^2$ y $\left(\sum x_i\right)^2$ no son lo mismo. Idéntica observación se debe hacer para los términos $\sum\left(x_i y_i\right)$ y $\sum x_i \sum y_i$.

Es recomendable construir una tabla como \ref{tablamincua}, para así ordenar la información y facilitar los cálculos. Las cuatro sumas en la última línea, son los valores necesarios para calcular $m$ y $b$. Los valores de $m$ y $b$ que se obtengan por el método de los mínimos cuadrados, deberían ser muy próximos a los obtenidos directamente utilizando el método gráfico.
\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline $y_i [\,\,]$ & $x_i [\,\,]$ & $x_i^2 [\,\,]$& $x_i y_i [\,\,]$ \\
\hline \hline $y_1$ & $x_1$ & $x_1^2$ & $x_1 y_1$ \\
\hline $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
\hline $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
\hline $y_n$ & $x_n$ & $x_n^2$ & $x_n y_n$ \\ \hline
\hline $\sum y_i$ &$\sum x_i $& $\sum x_i^2$ & $\sum x_i y_i$ \\
\hline
\end{tabular}
\end{center}
\caption{Tabla para facilitar el uso del  método de mínimos cuadrados}
\label{tablamincua}
\end{table}


Actualmente es casi de rutina utilizar alguna herramienta computacional  que permite hacer los cálculos necesarios y los gráficos para el ajuste de la recta. Aunque el uso de este método no nos obliga a hacer el gráfico de la recta, por razones pedagógicas, es conveniente hacerlo para así observar más claramente las desviaciones de los puntos experimentales con respecto a la recta calculada. 

Una vez obtenido los valores de $m$ y ${b}$, es necesario calcular sus errores correspondientes $\Delta m$ y $\Delta b$. Esto lo podemos hacer calculando las desviaciones estándar  de la pendiente y la ordenada al origen, calculadas a partir de la distribución de diferencias $\Delta y_i$, ecuación (\ref{deltay}),  respecto de la mejor línea de ajuste. Sea  $S_y$  la  desviación estándar de $y$ respecto a la línea recta obtenida por mínimos cuadrados:
\begin{equation}
S_y=\left[\frac{\sum\limits_{i=1}^n \left(y_i-b-m x_i\right)}{n-2}\right]^{\frac{1}{2}} \,.
\end{equation}

Para calcular estos valores de $\Delta m$ y $\Delta b$ se utilizan las siguientes expresiones:
\begin{eqnarray}
\Delta m & =\left[\frac{n}{n \sum\limits_{i=1}^n\left(x_i\right)^2-\left(\sum\limits_{i=1}^n x_i\right)^2}\right]^{\frac{1}{2}} S_y 
\label{Delm}\\
\Delta b & =\left[\frac{\sum\limits_{i=1}^n\left(x_i\right)^2}{n \sum\limits_{i=1}^n\left(x_i\right)^2-\left(\sum\limits_{i=1}^n x_i\right)^2}\right]^{\frac{1}{2}} S_y
\label{Delb}
\end{eqnarray}

La cantidad $S_y$ representa la llamada desviación estándar de $y$ respecto a la línea recta obtenida.

Finalmente para calcular $S_y$ se puede utilizar como ayuda la tabla \ref{tablamincua2}
\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline$x_i [\,\,]$ & $y_i [\,\,]$ & $y_i-m x_i-b$ & $(y_i-m x_i-b)^2$ \\
\hline \hline$x_1$ & $y_1$ & $y_1-m x_1-b$ & $\left(y_1-m x_1-b\right)^2$ \\
\hline$x_2$ & $y_2$ & $y_2-m x_2-b$ & $\left(y_2-m x_2-b\right)^2$ \\
\hline$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
\hline$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
\hline$x_n$ & $y_n$ & $y_n-m x_n-b$ & $\left(y_n-m x_n-b\right)^2$ \\ \hline
\hline & & & $\sum\limits_{i=1}^n \qquad \qquad \quad$ \\
\hline
\end{tabular}
\end{center}
\caption{Tabla para facilitar los cálculos de $S_y$.}
\label{tablamincua2}
\end{table}

\paragraph{Ejemplo 7.}

En un experimento sobre cinemática un grupo de estudiantes mide los tiempos con los que se desplaza  un móvil en un riel de aire. Lis tiempos son medidos en segundos usando un cronómetro de sensibilidad $S=0,01$ s. Un instrumento de mejor precisión mide las velocidades con las que se desplaza el móvil, este instrumento tiene una sensibilidad de $0,001$ m/s.  Los datos se muestran en la tabla \ref{datos1}.
\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|}
\hline $t_i \pm 0,01 (\mathrm{s})$ & $v_i \pm 0,01 (\mathrm{m/s})$  \\\hline \hline 
\hline $0,00$ & 1.00 \\
\hline $0,10$ & 1.64 \\
\hline $0,20$ & 1.51 \\
\hline $0,30$ & 2.03 \\
\hline $0,40$ & 2.75 \\
\hline $0,50$ & 3.59 \\
\hline $0,60$ & 4.87 \\
\hline $0,70$ & 5.23 \\
\hline $0,80$ & 5.44 \\
\hline $1,00$ & 6.37 \\
\hline
\end{tabular}
\end{center}
\caption{Mediciones de la velocidad de un cuerpo en función del tiempo}
\label{datos1}
\end{table}

Al graficar los datos anteriores se obtiene la figura
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.5in,width=2.5in]{figuras/fig12}  
\caption{Gráfico de los datos $v$ vs $t$ de la tabla \ref{datos1}.}
\label{figdatos1}
\end{center}
\end{figure}

Es recomendable calcular las siguientes sumas:
$$
\begin{array}{c|c|c|c|c}
n&\sum_{i=1}^n t_i & \sum_{i=1}^n v_i   & \sum_{i=1}^n t_i^2  & \sum_{i=1}^n t_i v_i \\ \hline\hline 
10 & 4.60 & 34.43 & 3.04 & 21.3
\end{array}
$$
$$
\Delta=n\sum\limits_{i=1}^n t_i^2-\left(\sum\limits_{i=1}^n t_i\right)^2= 
10(3.04) - \left(4.60 \right)^2= 9.24 \,\, \mathrm{s}^2
$$
$$
b=\dfrac{\sum\limits_{i=1}^n t_i^2 \sum\limits_{i=1}^n v_i-\sum\limits_{i=1}^n t_i \sum\limits_{i=1}^n t_i v_i}{\Delta} =
\frac{(3.04)  (34.43) -(4.60) (21.3)}{9.24} = 0.724 \,\, \mathrm{m/s}
$$
$$
m =\dfrac{n \sum\limits_{i=1}^n t_i v_i-\sum\limits_{i=1}^n t_i \sum\limits_{i=1}^n v_i}{\Delta} =\frac{10(21.3)  -(4.60) ( 34.43)}{9.24}= 5.91\,\, \mathrm{m/s^2}
$$

Procedemos a calcular los errores 
$$
\begin{array}{c|c}
n& \sum\limits_{i=1}^n \left(v_i-b-m t_i\right)  \\ \hline\hline 
10 & 6.63 
\end{array}
$$
La desviación estándar de $y$:
$$
S_y=\left[\frac{\sum\limits_{i=1}^n \left(v_i-b-m t_i\right)^2}{n-2}\right]^{\frac{1}{2}}=
\left(\frac{6.63}{8}\right)^{\frac{1}{2}}=0.91 \,.
$$
y los errores 
$$
\begin{aligned}
\Delta m & =\left[\frac{n}{\Delta}\right]^{\frac{1}{2}} S_y = \left[\frac{10}{9.24}\right]^{\frac{1}{2}} (0.91)=0.95 \\
\Delta b & =\left[\frac{\sum\limits_{i=1}^n\left(t_i\right)^2}{\Delta}\right]^{\frac{1}{2}} S_y= 
\left[\frac{3.04}{9.24}\right]^{\frac{1}{2}} (0.91)= 0.52
\end{aligned}
$$

Por lo tanto nuestro resultado será:
$$
v=mt + b= 5.91 t + 0.724 \,\, \mathrm{m/s}
$$
donde $m=5.91 \pm 0.95$ y $b=0.72 \pm 0.52$.

En Python podemos hacer todos los casos anteriores, incluida la figura \ref{figdatos1}, pero primero debemos ingresar los datos
\begin{lstlisting}[language=Python]    
yn=  array([1.000, 1.64, 1.51, 2.03, 2.75, 3.59, 4.87, 5.23, 5.44, 6.37])
xn = array([0.00, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 1.00])
\end{lstlisting}

La gráfica de la figura \ref{figdatos1} se obtiene a partir de las siguientes lineas de código:
\begin{lstlisting}[language=Python] 
plt.scatter(xn, yn, marker='*')
plt.title(r'Velocidad vs tiempo', fontsize=20)
plt.xlabel(r'$t$ [s]', fontsize=16)
plt.ylabel(r'$v$ [m/s]', fontsize=16)
\end{lstlisting}

Para usar las ecuaciones (\ref{emeyb1})-(\ref{emeyb2}) hagamos primero los siguientes cálculos intermedios
\begin{lstlisting}[language=Python] 
#Se obtiene el valor de n (numero de datos)
n=len(xn)
#Las sumatorias necesarias 
Sum_x=sum(xn)
Sum_y=sum(yn)
Sum_xx=sum(xn**2)
Sum_xy=sum(xn*yn)
print(n,',', Sum_x, ',',Sum_y,',', Sum_xx,',', Sum_xy)
\end{lstlisting}
\begin{tcolorbox}[width=\textwidth,colback={ghostwhite}]   
{\small 
10 , 4.6 , 34.43 , 3.04 , 21.275
}
\end{tcolorbox} 

Y finalmente calculamos $b$ y $m$
\begin{lstlisting}[language=Python] 
# Se escriben las ecuaciones para b y m 
b=(Sum_xx*Sum_y-Sum_xy*Sum_x)/(n*Sum_xx-Sum_x**2)
m=(n*Sum_xy-Sum_x*Sum_y)/(n*Sum_xx-Sum_x**2)
print('m=',m, ',', 'b=',b)
\end{lstlisting}
\begin{tcolorbox}[width=\textwidth,colback={ghostwhite}]   
{\small 
m= 5.884415584415585 , b= 0.7361688311688325
}
\end{tcolorbox} 

Notemos lo diferente del valor de $m$ con respecto al obtenido anteriormente, esta diferencia obviamente se debe a que anteriormente fuimos haciendo redondeos en la operaciones. 

Veamos la recta y los datos
\begin{lstlisting}[language=Python] 
# La gráfica con los datos y la recta que mejor se ajusta 
x=xn
y=m*x+b
#
plt.scatter(xn, yn, color='b',marker='+')
plt.grid(linestyle='dotted')
plt.plot(x, y, color='r')
plt.title(r'Velocidad vs tiempo', fontsize=20)
plt.xlabel(r'$t$ [s]', fontsize=16)
plt.ylabel(r'$v$ [m/s]', fontsize=16)
plt.xlim(-0.1, 1.1)
plt.text(0.6, 1.0, '$y=(5.88) x + 0.736$', fontsize=12)
plt.show()
\end{lstlisting}
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.6in,width=3.0in]{figuras/fig13}  
\label{figdatos2}
\end{center}
\end{figure}

El siguiente paso es calcular $\Delta b$ y $\Delta m$

\begin{lstlisting}[language=Python] 
# Escribimos las sumatorias para calcular Sy
Sum_d= Sum_y-b-m*Sum_x
Sy=sqrt(Sum_d/(n-2))
print(n,',', Sum_d,',', Sy)
\end{lstlisting}
\begin{tcolorbox}[width=\textwidth,colback={ghostwhite}]   
{\small 
10 , 6.625519480519479 , 0.9100494135292516
}
\end{tcolorbox}

Los respectivos errores se obtienen de las ecuaciones (\ref{Delm}) y (\ref{Delb}) 

\begin{lstlisting}[language=Python] 
Dm= (n/((n*Sum_xx-Sum_x**2)))**(1/2)*Sy
Db= (Sum_xx/((n*Sum_xx-Sum_x**2)))**(1/2)*Sy
print('Dm=', Dm, ',', 'Db=',Db)
\end{lstlisting}
\begin{tcolorbox}[width=\textwidth,colback={ghostwhite}]   
{\small 
Dm= 0.9467362111662778 , Db= 0.5219943236034063
}
\end{tcolorbox}

Por lo tanto:
$$
v= 5.88 t + 0.736 \,\, \mathrm{m/s}
$$
donde: $m=5.88 \pm 0.95$ y $b=0.74 \pm 0.52$.



\section{Análisis Gráfico de Funciones}
En el análisis de un experimento generalmente se dispone de un conjunto de datos que de acuerdo a la teoría del fenómeno en estudio debe corresponder a una cierta ley física. ley  que se expresa mediante una ecuación matemática.  Este análisis se puede lograr graficando los valores experimentales que seguramente seguirán una cierta curva que corresponde a la tendencia de los puntos.  La idea es comparar la forma de la curva obtenida por la mediciones con la predicha por la teoría. Si la comparación muestran la misma tendencia se concluye que esto es una comprobación experimental de la teoría considerada.

Como es más fácil obtener la información de un gráfico lineal, entonces se procede a elegir convenientemente las variables de modo de obtener una función lineal. A continuación se mostrará como algunas de las funciones más conocidas pueden ser llevadas a un gráfico lineal.

\subsection{Función exponencial}
Dada la función 
\begin{equation}
y(x)=k a^{b x}
\label{funexp}
\end{equation}
donde $k, a$ y $b$ son constantes. Si  $b>0$  la exponencial es creciente, mientras que si si $b < 0$, la exponencial es decreciente. Notemos  que en $x=0$, $y=k$, por lo que $k$ resulta ser la ordenada al origen, es decir, la curva intercepta al eje de las ordenadas en el punto $(0, k)$.

Tomando logaritmos se tiene:
\begin{equation}
\log (y)=b \log(a) x +\log (k)
\label{funexplin}
\end{equation}
Recordemos que si por ejemplo $a=10$ debemos tomar  logaritmo en base diez. 

Si hacemos una gráfica directamente $\log y$ en función de $x$  se obtendrá una recta, pero para ello habría que calcular los logaritmos de $y$. Este cálculo puede ser evitado usando un papel especial llamado papel semi-logarítmico, en el cual uno de los ejes tiene las divisiones proporcionales a los logaritmos decimales y el otro es lineal. 

En la escala logarítmica existen ciclos, donde un ciclo corresponde al conjunto de números entre dos potencias de diez (1 a $10; 10$ a $100; 100$ a 1000 ó 0,1 a 1; etc.).

El gráfico de la función $y=k a^{bx}$ es una recta porque la ecuación (\ref{funexplin}) puede ser escrita como
$$
u=m x+v \,,
$$
donde: $u =\log(y)$,  $m =b \log(a)$ y  $v=\log (k)$.

Para calcular la pendiente de la recta hay que considerar que se está trabajando con logaritmos:
$$
\text {pendiente}=m=\frac{u_2-u_1}{x_2-x_1}  =\frac{\log y_2-\log y_1}{x_2-x_1}=b \log a
$$

Es de hacer notar que al graficar en papel semi-logarítmico y llevar los valores en la escala logarítmica, se llevan directamente los números a la escala y no se calculan los logaritmos, pero al calcular la pendiente si es necesario hacerlo. Además si se está utilizando papel semi-logarítmico, $k$ es el corte de la recta en $x=0$.

En las siguientes lineas de código podemos interpretar lo expuesto anteriormente tomando la función exponencial siguiente:
$$
y = 5\cdot 10^{\frac{x}{3}}
$$
cuya gráfica la podemoa hacer de la manera siguiente
\begin{lstlisting}[language=Python] 
x = arange(10)
y = 5*10**(1/3*x)
plt.plot(x, y, 'o')
plt.show()
\end{lstlisting}
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.4in,width=2.9in]{figuras/fig14}  
\label{figexp1}
\end{center}
\end{figure}

Ahora la función lineal pero en escala logarítmica
\begin{lstlisting}[language=Python] 
plt.plot(x, y, '-o')
plt.yscale("log")
plt.show()
\end{lstlisting}
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.4in,width=2.9in]{figuras/fig15}  
\label{figexp1lin}
\end{center}
\end{figure}

\newpage
\subsection{Función potencial}
Dada la función:
\begin{equation}
y= c x^m
\label{funpot}
\end{equation}
donde $m$ y $c$ son constantes. 

Tomando logaritmos decimales  se tiene:
\begin{equation}
\log (y)=m \log (x)+\log (c)
\label{funpotlin}
\end{equation}

Si se hace una gráfica directamente $\log y$ en función de $\log x$ se obtendrá una recta, pero habría que calcular los logaritmos decimales de $y$ y de $x$. Esto se puede  evitar  usando un papel especial llamado papel logarítmico (comúnmente llamado $\log-\log$ ), el cual tiene ambas escalas proporcionales a los logaritmos decimales.

El gráfico de la función $y=c x^m$ es una recta porque la ecuación (\ref{funpotlin}) se puede escribir como:
$$
v=m u+k \,,
$$
donde: $v =\log(y) $, $u=\log(x) $ y $k=\log(c)$

La pendiente $m$ de la recta está dada por:
$$
m =\frac{v_2-v_1}{u_2-u_1}  =\frac{\log y_2-\log y_1}{\log x_2-\log x_1}=\frac{\log \left(\frac{y_2}{y_1}\right)}{\log \left(\frac{x_2}{x_1}\right)}
$$
y $c$ representa el corte de la recta en $x=1(\log 1=0)$.

Consideremos la  función potencial siguiente:
$$
y = 8\ x^{3}
$$

Procedemos a realizar su gráfica:
\begin{lstlisting}[language=Python] 
x = arange(20)
y = 8*x**(3)
plt.plot(x, y, '*')
plt.show()
\end{lstlisting}
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.4in,width=2.9in]{figuras/fig16}  
\label{figexp1}
\end{center}
\end{figure}
\newpage

Ahora la función lineal pero en escala log-log
\begin{lstlisting}[language=Python] 
plt.plot(x, y, '-*')
plt.xscale("log")
plt.yscale("log")
plt.show()
\end{lstlisting}
\begin{figure}[h]
\begin{center}
\includegraphics[height=2.4in,width=2.9in]{figuras/fig17}  
\label{figexp1lin}
\end{center}
\end{figure}



